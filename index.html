<!DOCTYPE html>
<html>
	<head>
		<!-- Page formatting information -->
		<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
		<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
		
		<!-- Include stylesheet for calculator -->
		<link rel="stylesheet" type="text/css" href="calc_styles.css"></link>

		<!-- Include the globals and the  text-to-display file of the relevant language:
			make sure to select "calc_English.js" or "calc_Spanish.js"--> 
			
		<script src="calc_English.js" type="text/javascript"></script>
		<script src="globals.js" type="text/javascript"></script>
		
		<!-- Include jquery -->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
		
		<script>
			document.title = CALC_TITLE; 		// Adds title to calc from calc_Language.js
		</script>
		

	</head>
	<body onload="init();">
		<div id="left_hand_side">
			 
			<h1 id="header"></h1>
			<h3 id="sub_header"></h3>
			<h5 id="instructions"></h5>
			<form id="calc_form" class="form">
				<div>
					<label for="ppl" class="num">Number of people in your household: </label>
					<input type="number" id="ppl" value="1" min="1" max="9999"/>
				</div>
				<br>
				<div>
					<label for="ppl2" class="num">Number of cats in my garage: </label>
					<input type="number" id="ppl2" value="1" min="1" max="9999"/>
				</div>
				<br>
			</form>
			<div class="button">
				<button>Calculate!</button>
			</div>
			
		</div>
		<div id="right_hand_side">
		</div>
		


		<script>
			
		
			////////////////////////////////////////////////////////////////////
			////						function init() 					////
			//// 															////
			////	Loads the text in the correct language, and sets up 	////
			////	some basic form parameters.								////
			////////////////////////////////////////////////////////////////////
		
			function init() {
				document.getElementById("header").innerHTML = HEADER; 				// Puts the correct language text on the page
				document.getElementById("sub_header").innerHTML = SUB_HEADER;		//	for all elements
				document.getElementById("instructions").innerHTML = INSTRUCTIONS;
				
				form = document.getElementById("calc_form");						// Sets the global form so everyone can access it;
				form.noValidate = true;												// Turns off auto-validate so we can self-validate
				form.onchange = validateForm;
				form.onsubmit = validateForm;
				
				allData = {ppl: null};												// initializes the structure of the global, allData
			}
			
			
			////////////////////////////////////////////////////////////////////
			////				function updateInputs() 					////
			//// 															////
			////	Updates the global allData with the most-recently-		////
			////	entered data. 											////
			////////////////////////////////////////////////////////////////////
			
			function updateInputs(el) {
				allData[el.id] = Number(el.value);
				console.log(allData)
			
			}
			
			console.log(document.getElementById("ppl"))
			
			// This next function checks to see if the key that was pressed was 
			//	key #13 (enter/return). If so, it prevents the default 
			//	behavior of submitting the form. That way, we never send
			//	the data anywhere, just calculate some stuff with it here. 
			
			$(document).ready(function() {
				$(window).keydown(function(event){
					if(event.keyCode == 13) {
					event.preventDefault();
					return false;
					}
				});
			});
			
			// This next chunk of code checks to see if the input is valid
			//	and prevents illegal keystrokes. 
			
			$('input').bind('keypress', function (event) {
				if (!isKeyFunctional(event)) { 	// If the key isn't functional
					event.preventDefault(); 	// 	prevent behavior
					return false;		
				}
			});
			
			function isKeyFunctional(e) {
				
				if (numAcceptableKeys.includes(e.originalEvent.key)) { 	// If the current key is functional, return true
					return true;										//	otherwise, return false. 
				} else {
					return false;
				};
			}
			
			function validateForm(event) {
				 // fetch cross-browser event object and form node
				event = (event ? event : window.event);
				var element = (event.target ? event.target : event.srcElement);
				var rets = customValid(element);
				var valid = rets[0];
				var errMsg = rets[1];
				if (valid){
					updateInputs(element);
				} else {
					alert(errMsg);
				};
				
				
			}
			
			function customValid(el) {
				var valid = true;
				var value = el.value;
				var errorMsg = "";
				if (el.type == "number") {
					if (value < el.min)	{
						valid = false;
						errorMsg = "Uh oh!\nYou can't have fewer than "+el.min+" person!";
						//alert(errorMsg)
						el.value = el.min;
					} else if (value > el.max) {
						valid = false;
						errorMsg = "Currently, we don't allow more than "+el.max+" people. Sorry!";
						
						el.value = el.max;
					} else if (value % 1 != 0) {
						valid = false;
						errorMsg = "You can't have partial numbers of people...\n...stop chopping your children into bits!"
						el.value = parseInt(value, 10);
						//alert(errorMsg)
					
					};
				return [valid, errorMsg];
				
				
				}
			
			
			
			}
     
		</script>
	</body>
</html>
