<!DOCTYPE html>
<html>
	<head>
		<!-- Page formatting information -->
		<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
		<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
		
		<!-- Include stylesheet for calculator -->
		<link rel="stylesheet" type="text/css" href="calc_styles.css"></link>

		<!-- Include the globals and the  text-to-display file of the relevant language:
			make sure to select "calc_English.js" or "calc_Spanish.js"--> 
			
		<script src="calc_English.js" type="text/javascript"></script>
		<script src="globals.js" type="text/javascript"></script>
		
		<!-- Include jquery -->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
		
		<script>
			document.title = CALC_TITLE; 		// Adds title to calc from calc_Language.js
		</script>
		

	</head>
	<body onload="init();">
	
		<!-- Left hand side (inputs) for the calculator -->
		<div id="left_hand_side">
			<div id="LHS_inputs">
				<!-- the top text goes here -->
				<h1 id="header"></h1>
				<h3 id="sub_header"></h3>
				<h5 id="instructions"></h5>
				
				<!-- start the form!!! -->
				<form id="calc_form" class="form">
					
					<!-- Select your municipality -->
					<div>			
						<label for="municipality" id="muni0"></label>
						<select id="municipality" />
							<option value="0" id = "muni_val0"></option>
							<option value="1" id = "muni_val1"></option>
						</select>
						<div class = "error_lbl">
							<p id="municipality_error">.</p>
						</div>
					</div>
					<!-- How many people in your household? -->
					<div>
						<label for="ppl" id="ppl0"></label>
						<input type="number" id="ppl" value="1" min="1" max="9999" step="1"/>
						<div class = "error_lbl">
							<p id="ppl_error">.</p>
						</div>
					</div>
					
					<!-- Length of your roof -->
					<div>
						<label for="length" id = "length0"></label>
						<input type="number" id="length" value="1" min="0.1" max="99" step="any"/>
						<div class = "error_lbl">
							<p id="length_error">.</p>
						</div>
					</div>
					
					<!-- Width of your roof -->
					<div>
						<label for="width" id = "width0"></label>
						<input type="number" id="width" value="1" min="0.1" max="99" step="any"/>
						<div class = "error_lbl">
							<p id="width_error">.</p>
						</div>
					</div>
					<br>
					<!-- Type of roof -->
					<div>
						<label id="roof0"></label><br>
						<input type="radio" id="cement_roof" name="roof_type" value="0" checked>.<br>
						<input type="radio" id="sheet_roof" name="roof_type" value="1">.<br>
						<input type="radio" id="spanish_roof" name="roof_type" value="2">.
					</div>	
					<br>
					
					<!-- Tell us all your water uses! We assume you also will drink and cook with rainwater -->
					<div>			
						<label for="uses" id="uses0"></label>
						<br>
						<!-- Brush your teeth? -->
						<input type="checkbox" class="water_use" id="brush_chk">.<br>
						
						<!-- Wash your hands? -->
						<input type="checkbox" class="water_use" id="hands_chk">.<br>
						
						<!-- Water your garden? -->
						<input type="checkbox" class="water_use" id="garden_chk">.
						
						<!-- If you do water your garden, we'll grab a bit more info about that... -->
						<div class="extra_input" id="garden_extra" for="garden_chk">
							<label for="garden_size" id="garden_extra1"></label>
							<input type="number" id="garden_size" value="10" min="0.1" step="any"/>
						</div><br>
						
						<!-- Do the dishes? -->
						<input type="checkbox" class="water_use" id="dishes_chk">.
						
						<!-- If you wash dishes, give us some more info! -->
						<div class="extra_input" id="dishes_extra">
							<label for="dishes_washing_type" id="dishes_extra1"></label>
							<select id="dishes_washing_type" />
								<option value="0" id="dishes_extra1_val0"></option>
								<option value="1" id="dishes_extra1_val1"></option>
							</select>					
						</div><br>
						<!-- bathe? -->
						<input type="checkbox" class="water_use" id="bath_chk">.<br>
						
						<!-- Wash your clothes? -->
						<input type="checkbox" class="water_use" id="clothes_chk">.
						
						<!-- If you wash your clothes, how do you do it? -->
						<div class="extra_input" id="laundry_extra">
							<label for="laundry_type" id="laundry_extra1"></label>
							<select id="laundry_type" />
								<option value="0" id="laundry_extra1_val0"></option>
								<option value="1" id="laundry_extra1_val1"></option>
							</select>					
						</div><br>
						
						<!-- Flush the toilet? -->
						<input type="checkbox" class="water_use" id="toilet_chk">.<br>
						
						<!-- Do anything else with water? -->
						<input type="checkbox" class="water_use" id="other_chk">.
						
						<!-- If you do other stuff with water, tell us how much! --> 
						<div class = "etra_input" id="extra_house0">
							<div id="other_extra" class="extra_input">
								<label for="other_text" id = "other_extra1"></label>
								<input type="text" id="other_text" value=""/>
							</div>
							<div id="other_extra2" class="extra_input">
								<label for="other_value" id="other_extra3"></label>
								<input type="number" id="other_value" value="1" min="1" step="any"/>
							</div><br>
						</div>
					</div>	
					<br>
				</form>
				<!-- When you press this button, it stops letting you edit the form 
						and displays your inputs in a table -->
				<div class="button">
					<button onclick="replace('LHS_inputs','LHS_display'); " id="calc_button"></button>
				</div>
			</div>
			<div id="LHS_display">
				<h1 id="header_display"></h1>
				<h3 id="sub_header_display"></h3>
				<h5 id="instructions_display"></h5>
				<div class="to_indent">
					
					
					<p name="display_text">.</p>
					<p name="display_text">.</p>
					<p name="display_text">.</p>
					<p name="display_text">.</p>
					<p name="display_text">.</p>

					<br><br>
					<div class="button" align="center">
						<button onclick="replace('LHS_display','LHS_inputs');" id="back2inputs_button" ></button>
					</div>
				</div>
			</div>
		</div>
		
		<!-- The right hand side displays the calculated resullts in simple or complex form -->
		<div id="right_hand_side">
		
			<!-- First, by default, let's display the simple version -->
			<div id = "RHS_simple" align="center">
				<h1 class="res_title" id="RHS_simple_title"></h1>
			
				<!-- Display the amount used for just drinking+cooking -->
				<div class="output_number">
					<label id="essential_use0"></label><br>
					<label class="return_num" id="essential_use1">0</label><br>
					<label id="essential_use2"></label>
				</div>
				
				<!-- Display the minimum tank size required for all essential uses -->
				<div class="output_number">
					<label id="tank_size0"></label><br>
					<label class="return_num" id="tank_size1">0</label><br>
					<label id="tank_size2"></label>
				</div>
		
				<!-- Push this button to go to the complex view --> 
				<div style="text-align: center">
					<button onclick="replace('RHS_simple','RHS_complex')" id="more_info_button0" class="info_button"></button>
				</div>
			</div>
			<div id="RHS_complex" align="center">
				<h1 class="res_title" id="RHS_complex_title"></h1>
				<!-- Display the amount used for just drinking+cooking -->
				<div class="output_number">
					<label id="essential_use0_complex"></label><br>
					<label class="return_num" id="essential_use1_complex">0</label><br>
					<label id="essential_use2_complex"></label>
				</div>
				
				<!-- Display the TOTAL water used in a day -->
				<div class="output_number">
					<label id="total_use0_complex"></label><br>
					<label class="return_num" id="total_use1_complex">0</label><br>
					<label id="total_use2_complex"></label>
				</div>
				
				<div class="output_number" id="title_row">
					<label id="table_lbl"></label><br>
					<table align="center">
						<tr class="title_row">
							<th name="table_titles">.</th>
							<th name="table_titles">.</th>
							<th name="table_titles">.</th>
							<th name="table_titles">.</th>
						</tr>
						<tr>
							<th name="month" class="month_lbl">.</th>
							<th name="collected">.</th>
							<th name="used">.</th>
							<th name="inventory">.</th>
						</tr>
						<tr>
							<th name="month" class="month_lbl">.</th>
							<th name="collected">.</th>
							<th name="used">.</th>
							<th name="inventory">.</th>
						</tr>
						<tr>
							<th name="month" class="month_lbl">.</th>
							<th name="collected">.</th>
							<th name="used">.</th>
							<th name="inventory">.</th>
						</tr>
						<tr>
							<th name="month" class="month_lbl">.</th>
							<th name="collected">.</th>
							<th name="used">.</th>
							<th name="inventory">.</th>
						</tr>
						<tr>
							<th name="month" class="month_lbl">.</th>
							<th name="collected">.</th>
							<th name="used">.</th>
							<th name="inventory">.</th>
						</tr>
						<tr>
							<th name="month" class="month_lbl">.</th>
							<th name="collected">.</th>
							<th name="used">.</th>
							<th name="inventory">.</th>
						</tr>
						<tr>
							<th name="month" class="month_lbl">.</th>
							<th name="collected">.</th>
							<th name="used">.</th>
							<th name="inventory">.</th>
						</tr>
						<tr>
							<th name="month" class="month_lbl">.</th>
							<th name="collected">.</th>
							<th name="used">.</th>
							<th name="inventory">.</th>
						</tr>
						<tr>
							<th name="month" class="month_lbl">.</th>
							<th name="collected">.</th>
							<th name="used">.</th>
							<th name="inventory">.</th>
						</tr>
						<tr>
							<th name="month" class="month_lbl">.</th>
							<th name="collected">.</th>
							<th name="used">.</th>
							<th name="inventory">.</th>
						</tr>
						<tr>
							<th name="month" class="month_lbl">.</th>
							<th name="collected">.</th>
							<th name="used">.</th>
							<th name="inventory">.</th>
						</tr>
						<tr>
							<th name="month" class="month_lbl">.</th>
							<th name="collected">.</th>
							<th name="used">.</th>
							<th name="inventory">.</th>
						</tr>
					</table>
				</div>
				
				<!-- Display the minimum tank size required for all essential uses -->
				<div class="output_number">
					<label id="tank_size0_complex"></label><br>
					<label class="return_num" id="tank_size1_complex">0</label><br>
					<label id="tank_size2_complex"></label>
				</div>
				
				<br>
				<br>
				<br>
				<br>
				<br>
				<br>
				<div style="text-align: center">
					<button onclick="replace('RHS_complex','RHS_simple')" id="less_info_button0" class="info_button"></button>
				<div>
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			</div>
		
		
		</div>
		


		<script>
			
		
			////////////////////////////////////////////////////////////////////
			////						function init() 					////
			//// 															////
			////	Loads the text in the correct language, and sets up 	////
			////	some basic form parameters.	Initializes the form, 		////
			////	stores the starting values in a global, and hides all	////
			////	error messages and extra text that needs to be hidden. 	////
			////////////////////////////////////////////////////////////////////
		
			function init() {
							
				initForm();
							
				loadStartingValues();
				hideErrorLbls();
				hideExtraText();
				hideComplexOutput();
				
				displayStuff = inputs2outputs(allData);
				displayOutputs(displayStuff);
				
				addLanguageText();
				
				startInterrupt();
			};
			
			////////////////////////////////////////////////////////////////////
			////				function addLanguageText()					////
			//// 															////
			////	Loads the text in the correct display language.			////
			////////////////////////////////////////////////////////////////////
			
			function addLanguageText(){
				document.getElementById("header").innerHTML = HEADER; 				// Puts the correct language text on the page
				document.getElementById("sub_header").innerHTML = SUB_HEADER;		//	for all elements
				document.getElementById("instructions").innerHTML = INSTRUCTIONS;
				document.getElementById("muni0").innerHTML = MUNI0_LBL;
				document.getElementById("muni_val0").innerHTML = MUNI_VAL0_LBL;
				document.getElementById("muni_val1").innerHTML = MUNI_VAL1_LBL;
				document.getElementById("ppl0").innerHTML = PPL0_LBL;
				document.getElementById("length0").innerHTML = LENGTH0_LBL;
				document.getElementById("width0").innerHTML = WIDTH0_LBL;
				document.getElementById("roof0").innerHTML = ROOF0_LBL;
				document.getElementById("cement_roof").nextSibling.data = CEMENT_ROOF_LBL;
				document.getElementById("sheet_roof").nextSibling.data = SHEET_ROOF_LBL;
				document.getElementById("spanish_roof").nextSibling.data = SPANISH_ROOF_LBL;
				document.getElementById("uses0").innerHTML = USES0_LBL;
				document.getElementById("brush_chk").nextSibling.data = BRUSH_CHK_LBL;
				document.getElementById("hands_chk").nextSibling.data = HANDS_CHK_LBL;
				document.getElementById("garden_chk").nextSibling.data = GARDEN_CHK_LBL;
				document.getElementById("dishes_chk").nextSibling.data = DISHES_CHK_LBL;
				document.getElementById("bath_chk").nextSibling.data = BATH_CHK_LBL;
				document.getElementById("clothes_chk").nextSibling.data = CLOTHES_CHK_LBL;
				document.getElementById("toilet_chk").nextSibling.data = TOILET_CHK_LBL;
				document.getElementById("other_chk").nextSibling.data = OTHER_CHK_LBL;
				document.getElementById("garden_extra1").innerHTML = GARDEN_EXTRA1_LBL;
				document.getElementById("dishes_extra1").innerHTML = DISHES_EXTRA1_LBL;
				document.getElementById("dishes_extra1_val0").innerHTML = DISHES_EXTRA1_VAL0_LBL;
				document.getElementById("dishes_extra1_val1").innerHTML = DISHES_EXTRA1_VAL1_LBL;
				document.getElementById("laundry_extra1").innerHTML = LAUNDRY_EXTRA1_LBL;
				document.getElementById("laundry_extra1_val0").innerHTML = LAUNDRY_EXTRA1_VAL0_LBL;
				document.getElementById("laundry_extra1_val1").innerHTML = LAUNDRY_EXTRA1_VAL1_LBL;
				document.getElementById("other_extra1").innerHTML = OTHER_EXTRA1_LBL; 
				document.getElementById("other_extra3").innerHTML = OTHER_EXTRA3_LBL;
				document.getElementById("essential_use0").innerHTML = ESSENTIAL_USE0_LBL;
				document.getElementById("essential_use2").innerHTML = ESSENTIAL_USE2_LBL;
				document.getElementById("tank_size0").innerHTML = TANK_SIZE0_LBL;
				document.getElementById("tank_size2").innerHTML = TANK_SIZE2_LBL;
				document.getElementById("essential_use0_complex").innerHTML = ESSENTIAL_USE0_LBL;
				document.getElementById("essential_use2_complex").innerHTML = ESSENTIAL_USE2_LBL;
				document.getElementById("total_use0_complex").innerHTML = TOTAL_USE0_LBL;
				document.getElementById("total_use2_complex").innerHTML = TOTAL_USE2_LBL;
				document.getElementById("tank_size0_complex").innerHTML = TANK_SIZE0_LBL;
				document.getElementById("tank_size2_complex").innerHTML = TANK_SIZE2_LBL;
				document.getElementById("more_info_button0").innerHTML = MORE_INFO_BUTTON_LBL;
				document.getElementById("less_info_button0").innerHTML = LESS_INFO_BUTTON_LBL;
				document.getElementById("table_lbl").innerHTML = TABLE_LBL;
				document.getElementById("calc_button").innerHTML = CALC_BUTTON_LBL;
				document.getElementById("back2inputs_button").innerHTML = BACK2INPUTS_BUTTON_LBL;
				document.getElementById("header_display").innerHTML = HEADER;
				document.getElementById("sub_header_display").innerHTML = LHS_DISPLAY_TITLE;
				document.getElementById("instructions_display").innerHTML = LHS_INSTRUCTIONS;
				document.getElementById("RHS_simple_title").innerHTML = RHS_TITLE;
				document.getElementById("RHS_complex_title").innerHTML = RHS_TITLE;
				
				var els = document.getElementsByName("table_titles")
				for (var i=0; i<els.length; i++) {
					els[i].innerHTML = TABLE_TITLES[i];
				};
				
				var els = document.getElementsByName("month")
				for (var i=0; i<els.length; i++) {
					els[i].innerHTML = MONTHS[i];
				};
				
				updateOutputText(); 
				
			}
			
			////////////////////////////////////////////////////////////////////
			////				function initForm()							////
			//// 															////
			////	Initializes the form to not auto-validate so we can 	////
			////	display our own error messages.							////
			////////////////////////////////////////////////////////////////////
			
			function initForm() {
				form = document.getElementById("calc_form");						// Sets the global form so everyone can access it;
				form.noValidate = true;												// Turns off auto-validate so we can self-validate
				form.onchange = validateForm;
				form.onsubmit = validateForm;
			}
			
			////////////////////////////////////////////////////////////////////
			////				function loadStartingValues()				////
			//// 															////
			////	Loads the starting values into a global array.			////
			////////////////////////////////////////////////////////////////////			
				
			function loadStartingValues() {
				allData = {															// initializes the structure of the global, allData 
					municipality: Number(document.getElementById("municipality").value),
					ppl: Number(document.getElementById("ppl").value),				// 	and feeds in initial conditions.
					length: Number(document.getElementById("length").value),
					width: Number(document.getElementById("width").value),
					brush_chk: Boolean(document.getElementById("brush_chk").checked),
					hands_chk: Boolean(document.getElementById("hands_chk").checked),
					garden_chk: Boolean(document.getElementById("garden_chk").checked),
					dishes_chk: Boolean(document.getElementById("dishes_chk").checked),
					bath_chk: Boolean(document.getElementById("bath_chk").checked),
					clothes_chk: Boolean(document.getElementById("clothes_chk").checked),
					toilet_chk: Boolean(document.getElementById("toilet_chk").checked),
					other_chk: Boolean(document.getElementById("other_chk").checked),
					roof_type: Number(document.getElementById("cement_roof").value),
					garden_size: Number(document.getElementById("garden_size").value),
					laundry_type: Number(document.getElementById("laundry_type").value),
					garden_size: Number(document.getElementById("garden_size").value),
					other_text: String(document.getElementById("other_text").value),
					other_value: Number(document.getElementById("other_value").value),
					dishes_washing_type: Number(document.getElementById("dishes_washing_type").value)	
				};
			}	
			
			////////////////////////////////////////////////////////////////////
			////				function hideErrorLbls()					////
			//// 															////
			////	Hides error labels - pretty self-explanatory...			////
			////////////////////////////////////////////////////////////////////
			
			function hideErrorLbls() {
				var lblBoxes = document.getElementsByClassName("error_lbl");		// Turn all label boxes to opacity=0
				for (var i=0; i<lblBoxes.length; i++) {
					lblBoxes[i].style.opacity = 0;				
				};
			}
			
			////////////////////////////////////////////////////////////////////
			////				function hideExtraText()					////
			//// 															////
			////	Hides extra text that's tied to checkbox events			////
			////////////////////////////////////////////////////////////////////
			
			function hideExtraText() {
				var extra_inputs = document.getElementsByClassName("extra_input");		// Turn all label boxes to opacity=0
				for (var i=0; i<extra_inputs.length; i++) {
					extra_inputs[i].style.opacity = 0;				
				};			
			}
			
			function hideComplexOutput() {
				document.getElementById("RHS_complex").style.opacity = 0;
				document.getElementById("RHS_complex").hidden = true;
				document.getElementById("LHS_display").style.opacity = 0;
				document.getElementById("LHS_display").hidden = true;
				
			}

			
			////////////////////////////////////////////////////////////////////
			////				function updateInputs() 					////
			//// 															////
			////	Updates the global allData with the most-recently-		////
			////	entered data. 											////
			////////////////////////////////////////////////////////////////////
			
			function updateInputs(el) {
				if (el.type == "checkbox") {
					allData[el.id] = Boolean(el.checked);
				} else if (el.type == "number" | el.type == "select-one") {
					allData[el.id] = Number(el.value)
				} else if (el.type == "text") {
					allData[el.id] = String(el.value)
				} else if (el.type == "radio") {
					allData[el.name] =  el.value;
				};
				updateOutputText();
				displayStuff = inputs2outputs(allData);
				displayOutputs(displayStuff);
				
			}
			
			////////////////////////////////////////////////////////////////////
			////				function updateOutputText() 				////
			//// 															////
			////	Updates the text that's displayed on the LHS display	////
			////	screen after the user submits the form.					////
			////////////////////////////////////////////////////////////////////
			
			
			function updateOutputText() {
				DISPLAY_TXT[0] = MUN_TXT[0]+MUNIS[allData.municipality]+MUN_TXT[1]; 	// Display municipality message
				if (allData.ppl > 1) { 													// Parse person (1) or people (>1)
					DISPLAY_TXT[1] = PPL_TXT[0]+allData.ppl+PPL_TXT[2];
				} else {
					DISPLAY_TXT[1] = PPL_TXT[0]+allData.ppl+PPL_TXT[1];
				}
				DISPLAY_TXT[2] = LEN_WID_TXT[0]+allData.length+LEN_WID_TXT[1]+allData.width+LEN_WID_TXT[2];
				DISPLAY_TXT[3] = ROOF_TYPE_TXT[0]+ROOF_TYPES[allData.roof_type]+ROOF_TYPE_TXT[1];
				
				var els = document.getElementsByClassName("water_use"); 	// Display all other water uses. 
				DISPLAY_TXT[4] = USE_TXT[0];
				var counter = 0;
				for (var i=0; i<els.length; i++) {
					if (els[i].checked) {
						counter++;
						DISPLAY_TXT[4] = DISPLAY_TXT[4] + "<br>\xa0\xa0\xa0\xa0&#8226;\xa0" + USES[i]
					}
				}
				if (counter==0) {
					DISPLAY_TXT[4] = DISPLAY_TXT[4] + "<br>\xa0\xa0\xa0\xa0" + NO_USE;
				}
				
				var els = document.getElementsByName("display_text"); 		// Actually update all the <p> elements
				for (var i=0; i<els.length; i++) {
					els[i].innerHTML = DISPLAY_TXT[i];
				};
			}
			
			////////////////////////////////////////////////////////////////////
			////	function keydown(event) [Prevent form submit on enter]	////
			//// 															////
			////	checks to see if the key that was pressed was 			////
			////	key #13 (enter/return). If so, it prevents the default 	////
			////	behavior of submitting the form. That way, we never 	////
			////	send the data anywhere, just calculate some stuff with 	////
			////	it here. 												////		
			////////////////////////////////////////////////////////////////////

			
			$(document).ready(function() {
				$(window).keydown(function(event){
					if(event.keyCode == 13) {
					event.preventDefault();
					return false;
					}
				});
			});
			
			////////////////////////////////////////////////////////////////////
			////	function keypress(event) [check validity of keystroke]	////
			//// 															////
			////	checks to see if the key that was pressed was 			////
			////	a valid key. If not, doesn't allow keypress.			////		
			////////////////////////////////////////////////////////////////////
			
			$('input').bind('keypress', function (event) {
				if (event.target.type == "number") { 								// If it's being entered in a numeric field
					if (!numAcceptableKeys.includes(event.originalEvent.key)) { 	// If the key isn't a number or a movement key
						event.preventDefault(); 									// 	prevent behavior
						return false;		
					} else {
						return true;
					};
				} else { 							// If the field isn't a number, allow all behavior.
					return true;
				};	
			});
			
			////////////////////////////////////////////////////////////////////
			////				function validateForm(event)				////
			//// 															////
			////	When an event occurs, validates the event target. For 	////
			////	example, if a value is entered into a numberic input,	////
			////	this function validates that particular input. At the 	////
			////	end, it updates the global data. If the entry was 		////
			////	invalid it throws an error message, replaces the value,	////
			////	then loads the data.									////		
			////////////////////////////////////////////////////////////////////
			
			function validateForm(event) {
				 // fetch cross-browser event object and form node
				
				event = (event ? event : window.event);
				var element = (event.target ? event.target : event.srcElement);
				var rets = customValid(element);
				var valid = rets[0];
				var errMsg = rets[1];
				if (valid){
					updateInputs(element);
				} else {
					var errorText = document.getElementById(element.id+"_error");
					var errorBox = errorText.parentElement;
					errorText.innerHTML = errMsg;
					fadeIn(errorBox);
					setTimeout(function(){fadeOut(errorBox, false)}, ERROR_DISPLAY_TIME);
					element.validity.valid = false;
					updateInputs(element);
				};	
			}
			
			////////////////////////////////////////////////////////////////////
			////					fucntion customValid(el)				////
			//// 															////
			////	Takes an element, el, and validates it based on certain	////
			////	preset rules. Returns:									////
			////		[valid (boolean), errorMsg (string)]				////
			////////////////////////////////////////////////////////////////////
			
			
			function customValid(el) {
				var valid = true;
				var value = Number(el.value);
				var errorMsg = "";
				if (el.id == "ppl") {
					if (value < el.min)	{
						valid = false;
						errorMsg = PPL_MIN_E1+el.min+PPL_MIN_E2;
						el.value = el.min;
					} else if (value > el.max) {
						valid = false;
						errorMsg = PPL_MAX_E1+el.max+PPL_MAX_E2;
						el.value = el.max;
					} else if (value % 1 != 0 & el.id == "ppl") {
						valid = false;
						errorMsg = PPL_DECIMAL_E;
						el.value = parseInt(value, 10);
					};
				return [valid, errorMsg];
				} else if (el.id == "length" | el.id == "width") {
					if (value < el.min) {
						valid = false;
						errorMsg = SIZE_MIN_E1;
						el.value = el.min;
					} else if (value > el.max) {
						valid = false;
						errorMsg = SIZE_MAX_E1+el.max+SIZE_MAX_E2;
						el.value = el.max;
					};
					return [valid, errorMsg];
				} else {
				return [valid, errorMsg];
				};
			}
			
			////////////////////////////////////////////////////////////////////
			////				functions fadeIn(el), fadeOut(el) 			////
			//// 															////
			////	Fades in or out the passed element by adjusting the 	////
			////	the div element's opacity in steps. Many thanks to:		////////////////////
			////	http://www.chrisbuttery.com/articles/fade-in-fade-out-with-javascript/ 	////	
			////	for this simple and lovely bit of js. Cheers! 							////
			////	If the div is visible, fadeIn does nothing. If it's not, fade out 		////	
			////	does nothing. 															////
			////////////////////////////////////////////////////////////////////////////////////
			
			function fadeOut(el, hide){ 
				(function fade() {
					if ((el.style.opacity -= .09) < 0) {
					el.style.opacity = 0;
					} else {
					requestAnimationFrame(fade);
					}
				})();

				if (hide) {
					el.hidden = true;
				};
			}
			
			function fadeIn(el){
				
				el.style.opacity = 0;
				el.hidden = false; 
				
				(function fade() {
					var val = parseFloat(el.style.opacity);
					if (!((val += .075) > 1)) {
					el.style.opacity = val;
					requestAnimationFrame(fade);
					}
				})();
				
			}
			
			////////////////////////////////////////////////////////////////////
			////				function that executes every time 			////
			////				a checkbox is checked or unchecked 			////
			//// 															////
			////	Opens up the appropriate extra entry boxes depending on ////
			//// 	which checkbox is checked. 								////
			////////////////////////////////////////////////////////////////////
			
			$(':checkbox').change(function(event){
				var el = event.target;
				if (el.id == "garden_chk"){ 		// Open input field to get garden size
					if (el.checked) {
						fadeIn(document.getElementById("garden_extra"));
					} else {
						fadeOut(document.getElementById("garden_extra"), false);
					};
				} else if (el.id == "other_chk") { 	// Open input fields to get other info
					if (el.checked) {
						fadeIn(document.getElementById("extra_house0"));
						fadeIn(document.getElementById("other_extra"));
						fadeIn(document.getElementById("other_extra2"));
					} else {
						fadeOut(document.getElementById("extra_house0"), false);
						fadeOut(document.getElementById("other_extra"), false);
						fadeOut(document.getElementById("other_extra2"), false);
					};
				} else if (el.id == "dishes_chk") { // open input field to get type of dish washing
					if (el.checked) {
						fadeIn(document.getElementById("dishes_extra"));
					} else {
						fadeOut(document.getElementById("dishes_extra", false));
					};
				} else if (el.id == "clothes_chk") { // open input field to get type of laundry
					if (el.checked) {
						fadeIn(document.getElementById("laundry_extra"));
					} else {
						fadeOut(document.getElementById("laundry_extra"), false);
					};
				
				};
			});
			
			////////////////////////////////////////////////////////////////////
			////			--- BUG FIX FOR QUICK CHECKBOX CLICK --- 		////	
			////				function startInterrupt()					////
			//// 															////
			////	When a checkbox is clicked off-on-off rapidly, the	 	////
			////	extra text fades in, out, then in again, displaying 	////
			////	when it shouldn't be. These two functions are a patch	////
			////	over that bug. Every INTERRUPT_INTERVAL, this function 	////
			////	interrupts the code and checks all the checkboxes. If 	////
			////	they aren't checked, it makes sure that their 			////
			////	corresponding extra info boxes are hidden. This patch,	////
			////	as with most patches, isn't perfect. There's still a 	////
			////	half second or so where the label box pops up. Se lavi.	////
			////////////////////////////////////////////////////////////////////

			
			function startInterrupt() {
				var myInterval = setInterval( "hideUncheckedLbls()", INTERRUPT_INTERVAL);  // run
			}
			
			function hideUncheckedLbls() {
				els = document.getElementsByClassName("water_use");
				for (var i=0; i<els.length; i++) {	
					if (!els[i].checked) {
						els[i].nextElementSibling.style.opacity = 0;
					};
				};
			}
			
			////////////////////////////////////////////////////////////////////
			////			function showComplex()	/ showSimple() 			////
			//// 															////
			////	Hides one RHS panel and shows the other.				////
			////////////////////////////////////////////////////////////////////
			
			function replace(e2hide, e2show) {
				fadeOut(document.getElementById(e2hide), true);
				fadeIn(document.getElementById(e2show));
			}

			
			////////////////////////////////////////////////////////////////////
			////			function displayOutputs				 			////
			//// 															////
			////	Takes the calculated outputs and displays them on the	////
			////	right hand side panel. 									////
			////////////////////////////////////////////////////////////////////
			
			
			function displayOutputs(o) {
				document.getElementById("essential_use1").innerHTML = String(o.essentialDailyUse)+L_ADDON_LBL;
				document.getElementById("tank_size1").innerHTML = String(o.minTankSize)+L_ADDON_LBL;
				document.getElementById("essential_use1_complex").innerHTML = String(o.essentialDailyUse);
				document.getElementById("total_use1_complex").innerHTML = String(o.essentialDailyUse+o.totalOtherUse);
				document.getElementById("tank_size1_complex").innerHTML = String(o.minTankSize);
				var els = document.getElementsByName("collected");
				for (var i=0; i<els.length; i++) {
					els[i].innerHTML = String(o.monthlyCollection[i]);
				}
				var els = document.getElementsByName("used");
				for (var i=0; i<els.length; i++) {
					els[i].innerHTML = String(o.monthlyUse[i]);
				}
				var els = document.getElementsByName("inventory");
				for (var i=0; i<els.length; i++) {
					els[i].innerHTML = String(o.inventory[i]);
				}
				
			}
			
			//function widthShift() {
			//	var lhs_wid = document.getElementById("left_hand_side").style.width;
			//	var rhs_wid = document.getElementById("right_hand_side").style.width;
			//	document.getElementById("left_hand_side").style.width = rhs_wid;
			//	document.getElementById("right_hand_side").style.width = lhs_wid;
			//}
			
			////////////////////////////////////////////////////////////////////
			////			function inputs2outputs				 			////
			//// 															////
			////	Takes the user's entered inputs and converts them into	////
			////	outputs. This is the function that contains all of the 	////
			////	citeable-materials, it is the backbone of the actual	////
			////	calculation process.									////
			////															////
			////	Arguments:												////
			////		inputs --- a dictionary of all of the user inputs	////
			////															////	
			////	Returns:												////
			////		outputs --- a dictionary of things to display to 	////
			////					user. Fields include:					////
			////						essentialDailyUse [L/day]			////
			////						totalOtherUse [L/day]				////
			////						minTankSize [L]						////
			////						montlyUse [L] (a 1x12 array with a 	////
			////							cell for each month's use)		////
			////						monlyCollection [L] (1x12 array) 	////
			////															////
			////	Algorithm: 												////
			////		CHANTAL WILL FILL OUT THIS SECTION OF THE COMMENTS	////
			////		WITH HER USUAL FOCUS ON STYLE AND CLARITY =)		////
			////															////
			////	Update/Revision History:								////
			////		aaron krupp 	2/Nov/2016	empty function written	////	
			////									comments header written ////
			////////////////////////////////////////////////////////////////////			
			
			function inputs2outputs(inputs) {
				var outputs = {essentialDailyUse: 0,
					totalOtherUse: 0,
					minTankSize: 0,
					monthlyUse: Array.apply(null, Array(12)).map(Number.prototype.valueOf,0),
					monthlyCollection: Array.apply(null, Array(12)).map(Number.prototype.valueOf,0),					
					inventory: Array.apply(null, Array(12)).map(Number.prototype.valueOf,0)
				};
				
				////////////////////////////////////////////////////////////
				//                                                        //
				//      Variables which hold the number for the liters    //
				//      one person uses for each activity for one day     //
				//                                                        //
				//////////////////////////////////////////////////////////// 

				var l_day_brush = 0;
				var l_day_hands = 0;
				var l_day_garden = 0;
				var l_day_dishes = 0;
				var l_day_bath = 0;
				var l_machine = [12,24,24,32,40,53]; 							// number of liters a family with a certain amount of members (1,2,3,4) uses for one day for washing their clothes with a machine.
				var l_day_laundry = 0;
				var l_day_toilet = 0;
				var l_day_other = 0; 
				
				
				////////////////////////////////////////////////////////////
				//                                                        //
				// All these 'if functions' are used to calculate the     //
				// liters one family as a whole uses for each activity,   //
				// if this activity is checked (therefore time ppl.)      //
				//                                                        //
				////////////////////////////////////////////////////////////

				if (inputs.brush_chk){
					l_day_brush = 2*inputs.ppl;                         //calculates the liters one family needs for brushing their teeth one day 
				}

				if (inputs.hands_chk){
					l_day_hands = 13*inputs.ppl;                        //calculates the liters one family needs for washing their hands for one day
				}

				if (inputs.garden_chk){
					l_day_garden = inputs.garden_size * 3.6;                      // calculates the liters one family needs for watering their garden for one day (depends on the size of garden also)
				}

				if (inputs.dishes_chk){
					if (inputs.dishes_washing_type == 0){				// FAKE NUMBER ! calculates the amount of liters one family needs for one day when they wash their dishes by hand
						l_day_dishes = "FAKE NUMBER" * inputs.ppl;
					}
					else if (inputs.dishes_washing_type == 1){			// FAKE NUMBER ! calculates the amount of liters one family needs for one day when they wash their dishes using a machine 
						l_day_dishes = "FAKE NUMBER" * inputs.ppl;
					}
				} 

				if (inputs.bath_chk){
					l_day_bath = 100*inputs.ppl;                      	//calculates the liters one family needs for showering one day 
				}

				if (inputs.clothes_chk){
					if (inputs.laundry_type == 0){						 //calculates the liters one family needs for washing their clothes by hand one day
						l_day_laundry = 4.3 * inputs.ppl;
					}
					else if (inputs.laundry_type == 1){
						l_day_laundry = l_machine[inputs.ppl-1];		//calculates the liters one family needs for washing their clothes use a laundry machine (different frequencies thus different answers for size families, thus using an index)					      
					}
				} 				
				
				if (inputs.toilet_chk){
					l_day_toilet = 105*inputs.ppl;                      //calculates the liters one family needs to flush their toilet for one day
				}

				if (inputs.other_chk){
					l_day_other = inputs.other_value * inputs.ppl
				} 
				
	
				var essential = 5 * (inputs.ppl);                       	//variable which express the liters of drinking + de liters of cooking for one person
				var other_activities = l_day_brush + l_day_hands + l_day_garden + l_day_dishes + l_day_bath + l_day_laundry + l_day_toilet + l_day_other;      //variable which expresses the liters one family uses for all the other activities (if they will check one of these activities)

				//////////////////////////////////////////////////////
				//                                                  //
				//  Dataset for rainfall. Rainfall is given per     //
				//  month and is in mm.                             //
				//                                                  //
				//////////////////////////////////////////////////////

				var rainfall = {"0":[100.10, 128.70, 94.40, 94.20, 41.50, 12.40, 6.40, 13.70, 7.20, 6.00, 18.90, 42.20],
					"1":[1,2,3,4,5,6,7,8,9,10,11,12],	
				};

				var day_mon = [31,28,31,30,31,30,31,31,30,31,30,31];  // Calculation for days per months
				var area = inputs.length * inputs.width;      // Calculation for roof area, since people fill in their lenght and width of the roof, we calculate the roof area. 

				////////////////////////////////////////////////////////
				//                                                    //
				//  This whole thing calculates the water collected.  //
				//  If (inputs. municipality & inputs.rooftype &      //
				//  area) is there because it should only be          //
				//  calculate our water collected when all these      //
				//  things are filled in.                             //
				//                                                    //
				////////////////////////////////////////////////////////

			
					var watercollected = [0,0,0,0,0,0,0,0,0,0,0,0];
					for (var index = 0; index < day_mon.length;index++){
						watercollected[index] = area * rainfall[inputs.municipality][index] * EFFS[inputs.roof_type];
					}
				
				
				
				var mon_consumption = [0,0,0,0,0,0,0,0,0,0,0,0];      // Shows us an index for our monthly consumption. 12 times a 0 because we have 12 months. 

				//////////////////////////////////////////////////////////
				//                                                      //
				//  Calculates the monthly consumption. It takes        //
				//  essential (which is drinking and cooking) and       //
				//  all the other activities people have checked.       //
				//  And times it by the days a month has. This gives    //
				//  us 12 answers. A total consumption for every month. //
				//                                                      //
				//////////////////////////////////////////////////////////

				for (var index = 0; index<day_mon.length;index++){
					mon_consumption[index] = essential * day_mon[index] + other_activities * day_mon[index];
				} 

			
				var diff = 0;                                           // difference between water collected minus consumption. Here defined as 0.  
				var inventory = [0,0,0,0,0,0,0,0,0,0,0,0];              // Index which will be used later for inventory. Inventory is the amount of liters of water which is in each month in their tank. 

				//////////////////////////////////////////////////////////
				//                                                      //
				//  This whole thing calculates the inventory.          //
				//  So, the amount of liters which will be in their     //
				//  tank each month. Based on the efficiency, rainfall  //
				//  per municipality and size of the roof.              //
				//                                                      //
				//////////////////////////////////////////////////////////


				
					for (var i = 0; i < day_mon.length; i++){
						diff = watercollected[i] - mon_consumption[i];
						if(diff < 0){
							diff = 0;
						};
						if (i === 0){
							inventory[i] = diff;
						} else {
							inventory[i] = inventory[i-1] + diff;
						}
					}
				
			
			
			
				//////////////////////////////////////////////////////////
				//                                                      //
				//  Gives us the maximum of the index of the inventory  //
				//  which is per month. This max is thus where the      //
				//  montly collection is highest. The tank should       //
				//  be at least this size to be able to collect         //
				//  everymonth this amount.                             //
				//                                                      //
				//////////////////////////////////////////////////////////

				var cisternsize = Math.max.apply(null, inventory);		

								
				
					
				////////////////////////////////////////////////////////
				//                                                    //
				//                    Returns                         //
				//  Return tells us what we want to tell the people   //                     //
				////////////////////////////////////////////////////////

				// essentialDailyUse is the water which a family needs for drinking and cooking which needs to be for sure 'good' water. 
				// TotalOtherUse is the water which is drinking and cooking + the activities which the people have checked. 
				// Cisternsize is the size of the cistern which is needed to cover the specific demand of this family (based on the activities they have checked)

				
				outputs.essentialDailyUse = essential;
				outputs.totalOtherUse = other_activities; 
				outputs.minTankSize = cisternsize;
				outputs.monthlyUse = mon_consumption;
				outputs.monthlyCollection = watercollected;
				outputs.inventory = inventory;	 
				
				
				return outputs 				
				
			}
			
							
			
			
			
     
		</script>
	</body>
</html>
